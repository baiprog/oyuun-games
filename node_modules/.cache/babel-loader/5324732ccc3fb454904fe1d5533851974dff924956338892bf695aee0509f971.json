{"ast":null,"code":"import React,{useState}from\"react\";import{motion,AnimatePresence}from\"framer-motion\";import{createUserWithEmailAndPassword}from\"firebase/auth\";import{auth,db}from\"../firebase\";import{doc,setDoc,serverTimestamp}from\"firebase/firestore\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegisterModal=_ref=>{let{isOpen,onClose,onSuccess}=_ref;const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[promo,setPromo]=useState(\"\");const[error,setError]=useState(\"\");const handleSubmit=async e=>{e.preventDefault();setError(\"\");try{const userCredential=await createUserWithEmailAndPassword(auth,email,password);const user=userCredential.user;// Создаем документ пользователя в Firestore\nawait setDoc(doc(db,\"users\",user.uid),{email:user.email,balance:0,promo:promo||null,createdAt:serverTimestamp()});console.log(\"✅ Успешная регистрация и создание в Firestore:\",user);sonSuccess();// без задержки\n}catch(err){console.error(\"Ошибка регистрации:\",err);setError(err.message);}};return/*#__PURE__*/_jsx(AnimatePresence,{children:isOpen&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:onClose,children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-zinc-900 rounded-t-2xl w-full max-w-md p-6 pt-4 text-white\",initial:{y:\"100%\"},animate:{y:0},exit:{y:\"100%\"},transition:{type:\"spring\",stiffness:300,damping:30},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"text-white text-xl\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"space-y-4\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true,className:\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,className:\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"\\u041F\\u0440\\u043E\\u043C\\u043E\\u043A\\u043E\\u0434 (\\u043D\\u0435\\u043E\\u0431\\u044F\\u0437\\u0430\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:promo,onChange:e=>setPromo(e.target.value),className:\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 text-sm\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full bg-lime-400 text-black font-bold py-2 rounded\",children:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-center text-sm\",children:[\"\\u0415\\u0441\\u0442\\u044C \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442?\",\" \",/*#__PURE__*/_jsx(\"button\",{className:\"text-lime-400 font-semibold\",onClick:onClose,children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})]})})});};export default RegisterModal;","map":{"version":3,"names":["React","useState","motion","AnimatePresence","createUserWithEmailAndPassword","auth","db","doc","setDoc","serverTimestamp","jsx","_jsx","jsxs","_jsxs","RegisterModal","_ref","isOpen","onClose","onSuccess","email","setEmail","password","setPassword","promo","setPromo","error","setError","handleSubmit","e","preventDefault","userCredential","user","uid","balance","createdAt","console","log","sonSuccess","err","message","children","div","className","initial","opacity","animate","exit","onClick","y","transition","type","stiffness","damping","stopPropagation","onSubmit","value","onChange","target","required"],"sources":["/home/oyuungames/src/components/RegisterModal.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { createUserWithEmailAndPassword } from \"firebase/auth\";\nimport { auth, db } from \"../firebase\";\nimport { doc, setDoc, serverTimestamp } from \"firebase/firestore\";\n\nconst RegisterModal = ({ isOpen, onClose, onSuccess }) => {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [promo, setPromo] = useState(\"\");\n  const [error, setError] = useState(\"\");\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\"\");\n\n    try {\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n      const user = userCredential.user;\n\n      // Создаем документ пользователя в Firestore\n      await setDoc(doc(db, \"users\", user.uid), {\n        email: user.email,\n        balance: 0,\n        promo: promo || null,\n        createdAt: serverTimestamp()\n      });\n\n      console.log(\"✅ Успешная регистрация и создание в Firestore:\", user);\n      sonSuccess(); // без задержки\n    } catch (err) {\n      console.error(\"Ошибка регистрации:\", err);\n      setError(err.message);\n    }\n  };\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"fixed inset-0 z-50 flex items-end justify-center bg-black bg-opacity-50\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          onClick={onClose}\n        >\n          <motion.div\n            className=\"bg-zinc-900 rounded-t-2xl w-full max-w-md p-6 pt-4 text-white\"\n            initial={{ y: \"100%\" }}\n            animate={{ y: 0 }}\n            exit={{ y: \"100%\" }}\n            transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">Регистрация</h2>\n              <button onClick={onClose} className=\"text-white text-xl\">✕</button>\n            </div>\n\n            <form className=\"space-y-4\" onSubmit={handleSubmit}>\n              <div>\n                <label className=\"text-sm\">Email</label>\n                <input\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  className=\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm\">Пароль</label>\n                <input\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  className=\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"\n                />\n              </div>\n              <div>\n                <label className=\"text-sm\">Промокод (необязательно)</label>\n                <input\n                  type=\"text\"\n                  value={promo}\n                  onChange={(e) => setPromo(e.target.value)}\n                  className=\"w-full mt-1 p-2 rounded bg-zinc-800 text-white\"\n                />\n              </div>\n\n              {error && <div className=\"text-red-500 text-sm\">{error}</div>}\n\n              <button\n                type=\"submit\"\n                className=\"w-full bg-lime-400 text-black font-bold py-2 rounded\"\n              >\n                Зарегистрироваться\n              </button>\n            </form>\n\n            <div className=\"mt-4 text-center text-sm\">\n              Есть аккаунт?{\" \"}\n              <button className=\"text-lime-400 font-semibold\" onClick={onClose}>\n                Войти\n              </button>\n            </div>\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default RegisterModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}